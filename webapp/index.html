<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BudgetBeacon Web</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="stylesheet" href="styles.css?v=5" />
</head>
<body>
  <div class="scene-glow glow-a"></div>
  <div class="scene-glow glow-b"></div>
  <div class="scene-grid"></div>
  <main class="app">
    <header class="topbar">
      <div class="brand-copy">
        <p class="eyebrow">Personal Finance Hub</p>
        <h1>BudgetBeacon</h1>
        <p class="sub">Track every dollar, spot spending patterns, and stay ahead of your monthly budget.</p>
      </div>
      <div class="topbar-actions">
        <p class="brand-tag">Local-first web app</p>
        <button id="helpBtn" class="btn ghost">How To Use</button>
      </div>
    </header>

    <p id="demoBanner" class="demo-banner" hidden>
      Demo mode is active. Sample entries are loaded and marked for exploration.
    </p>

    <section class="stats" id="stats">
      <article class="card metric-card">
        <h2>Income</h2>
        <p id="incomeTotal" class="metric-value">$0.00</p>
      </article>
      <article class="card metric-card">
        <h2>Expenses</h2>
        <p id="expenseTotal" class="metric-value">$0.00</p>
      </article>
      <article class="card metric-card">
        <h2>Balance</h2>
        <p id="balanceTotal" class="metric-value">$0.00</p>
      </article>
      <article class="card metric-card">
        <h2>Budget Goal</h2>
        <p id="budgetGoal" class="metric-value">$0.00</p>
      </article>
      <article class="card metric-card">
        <h2>Budget Left</h2>
        <p id="budgetLeft" class="metric-value">$0.00</p>
      </article>
    </section>

    <section class="panel budget-progress">
      <div class="budget-progress-head">
        <h3>Budget Usage</h3>
        <p id="budgetProgressLabel">Set a budget goal to track your monthly pace.</p>
      </div>
      <p id="budgetScopeLabel" class="period-label">This month (current cycle)</p>
      <div class="progress-track" aria-hidden="true">
        <div id="budgetProgressFill" class="progress-fill"></div>
      </div>
    </section>

    <section class="layout">
      <aside class="panel form-panel">
        <section id="addEntrySection" class="form-section">
          <h3>Add Entry</h3>
          <label>Money Type
            <select id="typeInput">
              <option value="expense">Expense</option>
              <option value="income">Income</option>
            </select>
          </label>

          <label>Category
            <select id="categoryInput"></select>
          </label>
          <button id="manageCategoriesBtn" class="btn subtle" type="button">Manage Categories</button>

          <label>Amount
            <input id="amountInput" type="number" inputmode="decimal" min="0" step="0.01" placeholder="24.99" />
          </label>
          <p id="amountInlineError" class="field-hint" aria-live="polite"></p>

          <label>Note (optional)
            <input id="noteInput" type="text" placeholder="Example: weekly groceries" />
          </label>

          <label class="checkline">
            <input id="recurringToggleInput" type="checkbox" />
            Repeat this entry automatically
          </label>

          <label>Frequency
            <select id="recurringFrequencyInput">
              <option value="weekly">Weekly</option>
              <option value="monthly">Monthly</option>
            </select>
          </label>

          <label>Start Date
            <input id="recurringStartInput" type="date" />
          </label>

          <div class="row">
            <button id="saveBtn" class="btn primary">Save Entry</button>
            <button id="clearBtn" class="btn">Clear</button>
          </div>
        </section>

        <section class="form-section">
          <h3>Monthly Budget</h3>
          <label>Budget Goal
            <input id="budgetInput" type="number" inputmode="decimal" min="0" step="0.01" placeholder="2000" />
          </label>
          <p id="budgetInlineError" class="field-hint" aria-live="polite"></p>

          <label>Start Month On Day
            <input id="monthStartInput" type="number" min="1" max="28" step="1" value="1" />
          </label>
          <p class="field-hint">Use `1` for calendar months or another day for paycheck-style cycles.</p>

          <button id="saveBudgetBtn" class="btn">Save Budget Goal</button>

          <div class="row">
            <button id="exportDataBtn" class="btn">Export Backup</button>
            <button id="importDataBtn" class="btn">Import Backup</button>
          </div>

          <button id="syncNowBtn" class="btn">Sync Now (Cloud)</button>
          <p id="storageModeLabel" class="field-hint"></p>
          <p id="syncModeLabel" class="field-hint"></p>

          <button id="sampleDataBtn" class="btn">Load Sample Data</button>
          <input id="importFileInput" type="file" accept=".json,application/json" hidden />
        </section>

        <section class="form-section">
          <h3>Recurring Rules</h3>
          <ul id="recurringList" class="recurring-list"></ul>
        </section>
      </aside>

      <section class="panel data-panel">
        <div class="panel-head">
          <h3>Entries</h3>
          <p id="entryCount" class="panel-meta">0 shown</p>
        </div>

        <div class="scope-row">
          <div class="scope-toggle">
            <button id="scopeMonthBtn" type="button" class="btn scope-btn is-active">This Month</button>
            <button id="scopeAllBtn" type="button" class="btn scope-btn">All Time</button>
          </div>
          <p id="dataScopeLabel" class="panel-meta">This month</p>
        </div>

        <div class="filters">
          <label>Type
            <select id="filterType">
              <option value="all">All</option>
              <option value="income">Income</option>
              <option value="expense">Expense</option>
            </select>
          </label>
          <label>Category
            <select id="filterCategory">
              <option value="all">All</option>
            </select>
          </label>
          <label>Sort
            <select id="sortInput">
              <option value="date_desc">Date (Newest)</option>
              <option value="date_asc">Date (Oldest)</option>
              <option value="amount_desc">Amount (High to Low)</option>
              <option value="amount_asc">Amount (Low to High)</option>
            </select>
          </label>
          <label>Search
            <input id="searchInput" type="text" placeholder="Find by note/category" />
          </label>
          <button id="resetFiltersBtn" class="btn">Reset</button>
        </div>

        <div class="top-filter-row">
          <p class="panel-meta">Top categories</p>
          <div id="topCategoryFilters" class="top-category-filters"></div>
        </div>

        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Type</th>
                <th>Category</th>
                <th>Amount</th>
                <th>Note</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="entryRows"></tbody>
          </table>
          <p id="emptyState" class="empty">No entries yet. Add your first one on the left.</p>
        </div>
      </section>
    </section>

    <section class="layout charts">
      <article class="panel chart-panel">
        <h3>Monthly Expense Trend</h3>
        <canvas id="monthChart" height="220"></canvas>
      </article>
      <article class="panel chart-panel">
        <h3>Top Expense Categories</h3>
        <canvas id="categoryChart" height="220"></canvas>
      </article>
    </section>

    <p id="status" class="status" role="status" aria-live="polite">Ready.</p>
  </main>

  <dialog id="helpDialog">
    <h3>How To Use</h3>
    <p>1. Set your monthly budget goal and choose your month start day.</p>
    <p>2. Add each income/expense entry as it happens (press `Enter` to save quickly).</p>
    <p>3. Use `This Month / All Time`, sort, and filters to analyze entries.</p>
    <p>4. Data is saved in this browser unless cloud mode is explicitly enabled.</p>
    <form method="dialog">
      <button class="btn primary">Close</button>
    </form>
  </dialog>

  <dialog id="editDialog">
    <h3>Edit Entry</h3>
    <label>Money Type
      <select id="editTypeInput">
        <option value="expense">Expense</option>
        <option value="income">Income</option>
      </select>
    </label>
    <label>Category
      <select id="editCategoryInput"></select>
    </label>
    <label>Amount
      <input id="editAmountInput" type="number" inputmode="decimal" min="0" step="0.01" />
    </label>
    <p id="editAmountInlineError" class="field-hint" aria-live="polite"></p>
    <label>Note
      <input id="editNoteInput" type="text" />
    </label>
    <div class="row">
      <button id="saveEditBtn" class="btn primary">Save Changes</button>
      <button id="cancelEditBtn" class="btn" type="button">Cancel</button>
    </div>
  </dialog>

  <dialog id="categoryDialog">
    <h3>Manage Categories</h3>
    <p class="dialog-sub">Add, rename, recolor, or delete categories.</p>
    <label>Money Type
      <select id="categoryManagerType">
        <option value="expense">Expense</option>
        <option value="income">Income</option>
      </select>
    </label>
    <ul id="categoryManagerList" class="category-manager-list"></ul>
    <div class="category-add-grid">
      <label>New Category
        <input id="newCategoryNameInput" type="text" placeholder="Example: Subscriptions" />
      </label>
      <label>Color
        <input id="newCategoryColorInput" type="color" value="#2f7db5" />
      </label>
    </div>
    <div class="row">
      <button id="addCategoryBtn" class="btn primary" type="button">Add Category</button>
      <button id="closeCategoryDialogBtn" class="btn" type="button">Done</button>
    </div>
  </dialog>

  <dialog id="onboardingDialog">
    <h3 id="onboardTitle">Welcome to BudgetBeacon</h3>
    <p id="onboardBody">Let us quickly set up your budget flow.</p>
    <div class="row">
      <button id="onboardBackBtn" class="btn" type="button">Back</button>
      <button id="onboardNextBtn" class="btn primary" type="button">Next</button>
    </div>
    <button id="onboardSkipBtn" class="btn" type="button">Skip</button>
  </dialog>

  <script src="app.js?v=9"></script>
</body>
</html>
